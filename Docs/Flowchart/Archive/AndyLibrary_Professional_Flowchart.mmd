
flowchart TD
    %% Professional AndyLibrary User Process Flowchart
    %% Designed for management presentation
    
    %% Start/End Nodes
    START([ğŸš€ Start<br/>User Opens Browser])
    END([âœ… End<br/>Book Access Complete])
    
    %% Main Process Flow
    POWER_ON[âš¡ Power On<br/>Load Website]
    SCAN_ENV[ğŸ” Scan Environment<br/>Check Auth Status]
    GEN_MAP[ğŸ—ºï¸ Generate Map<br/>Load User Interface]
    PLAN_ROUTE[ğŸ¯ Plan Route<br/>Choose Auth Method]
    
    %% Authentication Decision
    AUTH_CHECK{ğŸ” User<br/>Authenticated?}
    
    %% Registration Flow
    VAC_ON[ğŸ”„ Vacuum On<br/>Start Registration]
    REG_VALID{âœ… Registration<br/>Valid?}
    SEND_EMAIL[ğŸ“§ Send Verification<br/>Email Process]
    EMAIL_SENT{ğŸ“¤ Email<br/>Sent?}
    VACUUM_FULL{ğŸ“§ Email<br/>Verified?}
    TOKEN_VALID{ğŸ« Token<br/>Valid?}
    
    %% Login Flow  
    LOGIN_PROCESS[ğŸ”‘ Login Process<br/>Authenticate User]
    USER_FOUND{ğŸ‘¤ User<br/>Found?}
    BATTERY_LOW{ğŸ”’ Account<br/>Locked?}
    LOGIN_SUCCESS{âœ… Login<br/>Successful?}
    
    %% Data Storage
    ROUTE[(ğŸ’¾ User Database<br/>Store User Data)]
    
    %% Google Drive Integration
    GDRIVE_SETUP[â˜ï¸ Google Drive Setup<br/>OAuth Configuration]
    GDRIVE_AUTH{ğŸŒ Google Drive<br/>Authorized?}
    FIND_FOLDER[ğŸ“ Find Library Folder<br/>Search Google Drive]
    FOLDER_EXISTS{ğŸ“‚ Library Folder<br/>Exists?}
    BOOK_SEARCH[ğŸ“š Search Book File<br/>Locate Requested Book]
    FILE_FOUND{ğŸ“– Book File<br/>Found?}
    
    %% Error States
    ERROR_IND[ğŸš¨ Error Indicator On<br/>Show Error Message]
    DUPLICATE_USER[âŒ Duplicate User<br/>Email Already Exists]
    VAC_OFF_1[ğŸ”´ Vacuum Off<br/>Email Verification Failed]
    TOKEN_EXPIRED[â° Token Expired<br/>Request New Verification]
    USER_NOT_FOUND[âŒ User Not Found<br/>Invalid Credentials]
    VAC_OFF_2[ğŸ”´ Vacuum Off<br/>Google Drive Failed]
    STOP_MOVING[ğŸ›‘ Stop Moving<br/>Registration Failed]
    
    %% Action States
    RETURN_DOCK[ğŸ  Return to Dock<br/>Show Login Form]
    POWER_OFF[â¹ï¸ Power Off<br/>Session Expired]
    
    %% MAIN FLOW CONNECTIONS
    START --> POWER_ON
    POWER_ON --> SCAN_ENV
    SCAN_ENV --> GEN_MAP
    GEN_MAP --> PLAN_ROUTE
    PLAN_ROUTE --> AUTH_CHECK
    
    %% AUTHENTICATION DECISION
    AUTH_CHECK -->|âŒ No| VAC_ON
    AUTH_CHECK -->|âœ… Yes| GDRIVE_SETUP
    
    %% REGISTRATION FLOW
    VAC_ON --> REG_VALID
    REG_VALID -->|âœ… Yes| SEND_EMAIL
    REG_VALID -->|âŒ No| DUPLICATE_USER
    
    SEND_EMAIL --> EMAIL_SENT
    EMAIL_SENT -->|âœ… Yes| VACUUM_FULL
    EMAIL_SENT -->|âŒ No| VAC_OFF_1
    
    VACUUM_FULL -->|âœ… Yes| TOKEN_VALID
    VACUUM_FULL -->|âŒ No| VAC_OFF_1
    
    TOKEN_VALID -->|âœ… Yes| LOGIN_PROCESS
    TOKEN_VALID -->|âŒ No| TOKEN_EXPIRED
    
    %% LOGIN FLOW
    LOGIN_PROCESS --> USER_FOUND
    USER_FOUND -->|âœ… Yes| BATTERY_LOW
    USER_FOUND -->|âŒ No| USER_NOT_FOUND
    
    BATTERY_LOW -->|âŒ No| LOGIN_SUCCESS
    BATTERY_LOW -->|ğŸ”’ Yes| RETURN_DOCK
    
    LOGIN_SUCCESS -->|âœ… Yes| ROUTE
    LOGIN_SUCCESS -->|âŒ No| RETURN_DOCK
    
    %% DATABASE STORAGE
    ROUTE --> GDRIVE_SETUP
    
    %% GOOGLE DRIVE FLOW
    GDRIVE_SETUP --> GDRIVE_AUTH
    GDRIVE_AUTH -->|âœ… Yes| FIND_FOLDER
    GDRIVE_AUTH -->|âŒ No| VAC_OFF_2
    
    FIND_FOLDER --> FOLDER_EXISTS
    FOLDER_EXISTS -->|âœ… Yes| BOOK_SEARCH
    FOLDER_EXISTS -->|âŒ No| VAC_OFF_2
    
    BOOK_SEARCH --> FILE_FOUND
    FILE_FOUND -->|âœ… Yes| END
    FILE_FOUND -->|âŒ No| VAC_OFF_2
    
    %% ACTION FLOW
    RETURN_DOCK --> POWER_OFF
    POWER_OFF --> END
    
    %% ERROR RECOVERY FLOWS
    DUPLICATE_USER --> ERROR_IND
    STOP_MOVING --> ERROR_IND
    VAC_OFF_1 --> ERROR_IND
    TOKEN_EXPIRED --> ERROR_IND
    USER_NOT_FOUND --> ERROR_IND
    VAC_OFF_2 --> ERROR_IND
    ERROR_IND -.->|ğŸ”„ Retry| PLAN_ROUTE
    
    %% PROFESSIONAL STYLING
    classDef startEndClass fill:#e1f5fe,stroke:#01579b,stroke-width:4px,color:#000,font-weight:bold
    classDef processClass fill:#f3e5f5,stroke:#4a148c,stroke-width:3px,color:#000,font-weight:bold
    classDef decisionClass fill:#fff3e0,stroke:#e65100,stroke-width:3px,color:#000,font-weight:bold
    classDef storageClass fill:#e8f5e8,stroke:#2e7d32,stroke-width:3px,color:#000,font-weight:bold
    classDef errorClass fill:#ffebee,stroke:#c62828,stroke-width:3px,color:#000,font-weight:bold
    classDef actionClass fill:#f1f8e9,stroke:#33691e,stroke-width:3px,color:#000,font-weight:bold
    
    %% APPLY STYLES
    class START,END startEndClass
    class POWER_ON,SCAN_ENV,GEN_MAP,PLAN_ROUTE,VAC_ON,SEND_EMAIL,LOGIN_PROCESS,GDRIVE_SETUP,FIND_FOLDER,BOOK_SEARCH processClass
    class AUTH_CHECK,REG_VALID,EMAIL_SENT,VACUUM_FULL,TOKEN_VALID,USER_FOUND,BATTERY_LOW,LOGIN_SUCCESS,GDRIVE_AUTH,FOLDER_EXISTS,FILE_FOUND decisionClass
    class ROUTE storageClass
    class ERROR_IND,DUPLICATE_USER,VAC_OFF_1,TOKEN_EXPIRED,USER_NOT_FOUND,VAC_OFF_2,STOP_MOVING errorClass
    class RETURN_DOCK,POWER_OFF actionClass
